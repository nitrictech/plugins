name: aws-cloudfront
display_name: CloudFront
type: entrypoint
description: "Creates CloudFront distributions with WAF and custom domain support"
icon: ./icon.svg
deployment:
  terraform: ./module

inputs:
  custom_domain:
    type: string
    nullable: true
    description: "Custom domain name (e.g. `cdn.example.com`). If null, uses default CloudFront domain (`*.cloudfront.net`)"
  custom_domain_is_root:
    type: bool
    description: "`false` (default) for sub-domains, `true` for root domains of the Route 53 hosted zone. Only applicable when custom_domain is provided"
  waf_enabled:
    type: bool
    description: "`false` (default) disables Web Application Firewall. `true` enables WAF protection against SQL injection and XSS attacks"
  waf_managed_rules:
    type: list(object)
    description: 'AWS Managed Rule Groups to enable. Only effective when waf_enabled is true (e.g. `[{"name": "AWSManagedRulesCommonRuleSet", "priority": 1}]`)'
  geo_restriction_type:
    type: string
    description: "Controls country access: `none` (default) allows all, `whitelist` allows only specified, `blacklist` blocks specified countries"
  geo_restriction_locations:
    type: list(string)
    description: "ISO 3166-1 alpha-2 country codes for geo restriction (e.g. `US`, `CA`, `GB`). Only used when geo_restriction_type is 'whitelist' or 'blacklist'"
  rate_limit_enabled:
    type: bool
    description: "`true` (default) limits requests per IP, protecting against DDoS attacks. `false` disables rate limiting"
  rate_limit_requests_per_5min:
    type: number
    description: "Maximum requests per 5-minute period per IP (e.g. `2000`). Only applied when rate_limit_enabled is true"
  default_cache_policy_id:
    type: string
    nullable: true
    description: "Controls caching behavior (headers, cookies, query strings in cache key). If null, creates custom policy that respects origin cache headers and includes auth headers"
  default_origin_request_policy_id:
    type: string
    description: "Controls which headers, cookies, and query strings are forwarded to origin server. Default uses AllViewerExceptHostHeader policy. Common IDs: `88a5eaf4-2fd4-4709-b370-b4c650ea3fcf` (CORS-S3Origin), `216adef6-5c7f-47e4-b989-5492eafa07d3` (AllViewer)"

outputs: {}
